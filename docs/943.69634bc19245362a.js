"use strict";(self.webpackChunkstock_control=self.webpackChunkstock_control||[]).push([[943],{5943:(K,y,r)=>{r.r(y),r.d(y,{CategoryModule:()=>B});var v=r(6895),c=r(433),C=r(8250),f=r(7579),l=r(2722),g=(()=>{return(i=g||(g={})).ADD_CATEGORY_EVNT="Adicionar Categoria",i.EDIT_CATEGORY_EVENT="Editar Categoria",g;var i})(),e=r(8256),A=r(249),d=r(805),p=r(5849),D=r(1135),S=r(5698);let F=(()=>{class i{constructor(){this.categoriesDataEmitter$=new D.X(null),this.categoriesDatas=[]}setCategoriesDatas(t){t&&(this.categoriesDataEmitter$.next(t),this.getProductsDatas())}getProductsDatas(){return this.categoriesDataEmitter$.pipe((0,S.q)(1)).subscribe({next:t=>{t&&(this.categoriesDatas=t)}}),this.categoriesDatas}static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var u=r(5593),E=r(1740);function Z(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleSubmitAddCategory())}),e.TgZ(2,"div",2),e._UZ(3,"input",3),e.TgZ(4,"div",4),e._UZ(5,"p-button",5),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.addCategorieForm),e.xp6(4),e.Q6J("disabled",!t.addCategorieForm.valid)}}function Y(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleSubmitEditCategory())}),e.TgZ(2,"div",2),e._UZ(3,"input",3),e.TgZ(4,"div",4),e._UZ(5,"p-button",5),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.editCategorieForm),e.xp6(4),e.Q6J("disabled",!t.editCategorieForm.valid)}}let I=(()=>{class i{constructor(t,o,a,s,n,V){this.formBuilder=t,this.categoryService=o,this.messageService=a,this.router=s,this.ref=n,this.categoryDTO=V,this.destroy$=new f.x,this.categoriesDatas=[],this.addCategorieForm=this.formBuilder.group({name:["",c.kI.required]}),this.editCategorieForm=this.formBuilder.group({name:["",c.kI.required]}),this.addCategorieAction=g.ADD_CATEGORY_EVNT,this.editCategorieAction=g.EDIT_CATEGORY_EVENT}ngOnInit(){this.categorytAction=this.ref?.data,console.log(this.categorytAction),console.log(this.categorytAction.categoriesDatas),this.categorytAction.event.action===this.editCategorieAction&&this.categorytAction.categoriesDatas&&(console.log("entrou aqui"),this.getCategorieSelectedDatas(this.categorytAction?.event?.id)),this.getAllCategories()}getAllCategories(){this.categoryService.getAllCategories().pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.categoriesDatas=t)},error:t=>{console.log(t),this.messageService.add({severity:"error",summary:"Erro.",detail:"Erro ao buscar categorias",life:2500})}})}handleSubmitAddCategory(){this.addCategorieForm.valid?this.categoryService.createCategorie(this.addCategorieForm.value).pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t&&this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Categoria Criada com sucesso",life:2500})},error:t=>{console.log(t),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao criar categoria",life:2500})}}):this.messageService.add({severity:"error",summary:"Erro",detail:"Por favor, preencha todos os campos corretamente",life:2500}),this.addCategorieForm.reset()}handleSubmitEditCategory(){this.editCategorieForm.value&&this.editCategorieForm.valid&&this.categorytAction?.event?.id&&this.categoryService.updateCategorie({categoryId:this.categorytAction?.event?.id,name:this.editCategorieForm?.value?.name}).pipe((0,l.R)(this.destroy$)).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Sucesso",detail:"Categoria editada  com sucesso",life:2500}),this.editCategorieForm.reset()},error:o=>{console.log(o),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao editar Categoria",life:2500}),this.editCategorieForm.reset()}})}getCategorieSelectedDatas(t){const o=this.categorytAction?.categoriesDatas;if(console.log(t),console.log(o),o&&o.length>0){const a=o.find(s=>s.categoryId===t);a&&(this.categoriesSelectedDatas=a,this.editCategorieForm.patchValue({name:this.categoriesSelectedDatas?.name}))}}getCategoriesDatas(){this.categoryService.getAllCategories().pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.categoriesDatas=t,this.categoriesDatas&&this.categoryDTO.setCategoriesDatas(this.categoriesDatas))}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(c.qu),e.Y36(A.H),e.Y36(d.ez),e.Y36(C.F0),e.Y36(p.S),e.Y36(F))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-category-form"]],decls:2,vars:2,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"card","flex","flex-column","md:flex-column","gap-3"],["pInputText","","placeholder","Nome","formControlName","name"],[1,"flex","flex-row","justify-content-center","align-content-center","align-items-center","m-1"],["type","submit","label","Concluir",3,"disabled"]],template:function(o,a){1&o&&(e.YNc(0,Z,6,2,"div",0),e.YNc(1,Y,6,2,"div",0)),2&o&&(e.Q6J("ngIf",(null==a.categorytAction||null==a.categorytAction.event?null:a.categorytAction.event.action)===a.addCategorieAction),e.xp6(1),e.Q6J("ngIf",(null==a.categorytAction.event?null:a.categorytAction.event.action)===a.editCategorieAction))},dependencies:[v.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,u.zx,E.o]})}return i})();var R=r(52),T=r(2137),b=r(4247),m=r(4684),x=r(3608);function $(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"th",7)(2,"div",8)(3,"div",8),e._uU(4," Nome "),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"p-sortIcon",9)(7,"p-columnFilter",10),e.qZA()()(),e.TgZ(8,"th")(9,"div",11)(10,"p-button",12),e.NdJ("onClick",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleCategoryEvent(a.addCategoryEvent))}),e.qZA()()()()}2&i&&(e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1))}function J(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"div",13)(5,"button",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,n=e.oxw();return e.KtG(n.handleCategoryEvent(n.editCategoryEvent,null==s?null:s.categoryId))}),e.qZA(),e.TgZ(6,"button",15),e.NdJ("click",function(){const s=e.CHM(t).$implicit,n=e.oxw();return e.KtG(n.handleDeleteCategory(null==s?null:s.categoryId,null==s?null:s.name))}),e.qZA()()()()}if(2&i){const t=h.$implicit;e.xp6(2),e.Oqu(null==t?null:t.name)}}const N=function(){return["mane","amount"]},O=function(){return{"min-width":"75rem"}};let w=(()=>{class i{constructor(){this.addCategoryEvent=g.ADD_CATEGORY_EVNT,this.editCategoryEvent=g.EDIT_CATEGORY_EVENT,this.categories=[],this.categoryEvent=new e.vpe,this.deleteCategoryEvent=new e.vpe}handleCategoryEvent(t,o){t&&""!==t&&this.categoryEvent.emit(o&&null!==o?{action:t,id:o}:{action:t})}handleDeleteCategory(t,o){null!==t&&""!==o&&this.deleteCategoryEvent.emit({categorie_id:t,categorie_name:o})}ngOnInit(){}static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-category-table"]],inputs:{categories:"categories"},outputs:{categoryEvent:"categoryEvent",deleteCategoryEvent:"deleteCategoryEvent"},decls:7,vars:11,consts:[[1,"grid"],[1,"col-12"],["styleClass","shadow-3 m-5 text-indigo-800","header","Categorias de produtos"],["dataKey","id","currentPageReportTemplate","Mostrando {first} de {last} de {totalRecords} Categorias",3,"value","rows","paginator","responsive","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","selectionChange"],["productsTable",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center"],["field","name"],["type","text","field","name","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],[1,"flex","justify-content-center"],["styleClass","p-button-info","icon","pi pi-plus","label","Adicionar","pTooltip","Adicionar Categoria","tooltipPosition","top",3,"onClick"],[1,"flex","justify-content-center","gap-3","align-content-center","align-items-center"],["pButton","","pRipple","","icon","pi pi-pencil","pTooltip","Editar Categoria","tooltipPosition","top",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","icon","pi pi-trash","pTooltip","Remover Categoria","tooltipPosition","top",1,"p-button-rounded","p-button-danger",3,"click"]],template:function(o,a){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"p-card",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(n){return a.categorieSelected=n}),e.YNc(5,$,11,3,"ng-template",5),e.YNc(6,J,7,1,"ng-template",6),e.qZA()()()()),2&o&&(e.xp6(3),e.Q6J("value",a.categories)("rows",10)("paginator",!0)("responsive",!0)("globalFilterFields",e.DdM(9,N))("tableStyle",e.DdM(10,O))("selection",a.categorieSelected)("rowHover",!0)("showCurrentPageReport",!0))},dependencies:[b.Z,d.jx,u.Hq,u.zx,m.iA,m.lQ,m.fz,m.xl,x.u]})}return i})();const M=function(){return{width:"50vw"}},G=[{path:"",component:(()=>{class i{constructor(t,o,a,s,n){this.categoriesService=t,this.dialogService=o,this.messageService=a,this.confirmationService=s,this.router=n,this.destroy$=new f.x,this.categoriesDatas=[]}ngOnInit(){this.getAllCategories()}getAPICategoriesDatas(){this.categoriesService.getAllCategories().pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.categoriesDatas=t)},error:t=>{console.log(t),this.router.navigate(["/dashboard"]),this.messageService.add({severity:"error",summary:"Erro.",detail:"Erro ao buscar categorias.",life:2e3})}})}getAllCategories(){this.categoriesService.getAllCategories().pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.categoriesDatas=t)},error:t=>{console.log(t),this.messageService.add({severity:"error",summary:"Erro.",detail:"Erro ao buscar categorias",life:2500}),this.router.navigate(["/dashboard"])}})}handleCategoryAction(t){t&&(console.log(t),this.ref=this.dialogService.open(I,{header:t?.action,width:"70%",contentStyle:{overFlow:"auto"},baseZIndex:1e4,maximizable:!0,data:{event:t,categoriesDatas:this.categoriesDatas}}),this.ref.onClose.pipe((0,l.R)(this.destroy$)).subscribe({next:()=>this.getAPICategoriesDatas()}))}handleDeleteCategorieAction(t){t&&this.confirmationService.confirm({message:`Confirma a exclus\xe3o da categoria ${t?.categorie_name}?`,header:"Confirma\xe7\xe3o de exclus\xe3o",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"N\xe3o",accept:()=>this.deleteCategory(t?.categorie_id)})}deleteCategory(t){this.categoriesService.deleteCategorie(t).pipe((0,l.R)(this.destroy$)).subscribe({next:o=>{this.getAPICategoriesDatas(),this.messageService.add({severity:"success",summary:"Sucesso",detail:"Categoria removida com sucesso",life:2500})},error:o=>{console.log(o),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao deletar a categoria",life:2500})}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(A.H),e.Y36(p.xA),e.Y36(d.ez),e.Y36(d.YP),e.Y36(C.F0))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-category-home"]],decls:3,vars:4,consts:[[3,"categories","categoryEvent","deleteCategoryEvent"]],template:function(o,a){1&o&&(e._UZ(0,"app-toolbar-navigation"),e.TgZ(1,"app-category-table",0),e.NdJ("categoryEvent",function(n){return a.handleCategoryAction(n)})("deleteCategoryEvent",function(n){return a.handleDeleteCategorieAction(n)}),e.qZA(),e._UZ(2,"p-confirmDialog")),2&o&&(e.xp6(1),e.Q6J("categories",a.categoriesDatas),e.xp6(1),e.Akn(e.DdM(3,M)))},dependencies:[R.p,T.Q,w]})}return i})()}];var H=r(4466),P=r(529),U=r(3520),z=r(7913),j=r(3054),Q=r(7188),_=r(4028);let B=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#o=this.\u0275inj=e.cJS({providers:[p.xA,d.YP],imports:[v.ez,c.u5,c.UX,C.Bz.forChild(G),H.m,P.JF,b.d,u.hJ,m.U$,E.j,U.zz,z.Iu,j.A,Q.L$,p.DL,_.kW,T.D,x.z]})}return i})()}}]);