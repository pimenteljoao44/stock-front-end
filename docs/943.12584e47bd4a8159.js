"use strict";(self.webpackChunkstock_control=self.webpackChunkstock_control||[]).push([[943],{5943:(q,v,r)=>{r.r(v),r.d(v,{CategoryModule:()=>W});var C=r(6895),c=r(433),y=r(8250),x=r(7579),l=r(2722),g=(()=>{return(o=g||(g={})).ADD_CATEGORY_EVNT="Adicionar Categoria",o.EDIT_CATEGORY_EVENT="Editar Categoria",g;var o})(),e=r(8256),A=r(249),p=r(805),h=r(5849),D=r(1135),F=r(5698);let Z=(()=>{class o{constructor(){this.categoriesDataEmitter$=new D.X(null),this.categoriesDatas=[]}setCategoriesDatas(t){t&&(this.categoriesDataEmitter$.next(t),this.getProductsDatas())}getProductsDatas(){return this.categoriesDataEmitter$.pipe((0,F.q)(1)).subscribe({next:t=>{t&&(this.categoriesDatas=t)}}),this.categoriesDatas}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var u=r(5593),E=r(1740),f=r(7932);const Y=function(){return{width:"50px",height:"50px",position:"fixed",top:"50%",left:"50%","margin-top":"-25px","margin-left":"-25px"}};function I(o,d){1&o&&e._UZ(0,"p-progressSpinner"),2&o&&e.Akn(e.DdM(2,Y))}function L(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleSubmitAddCategory())}),e.YNc(2,I,1,3,"p-progressSpinner",2),e.TgZ(3,"div",3),e._UZ(4,"input",4),e.TgZ(5,"div",5),e._UZ(6,"p-button",6),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.addCategorieForm),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(4),e.Q6J("disabled",!t.addCategorieForm.valid)}}function _(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleSubmitEditCategory())}),e.TgZ(2,"div",3),e._UZ(3,"input",4),e.TgZ(4,"div",5),e._UZ(5,"p-button",6),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.editCategorieForm),e.xp6(4),e.Q6J("disabled",!t.editCategorieForm.valid)}}let J=(()=>{class o{constructor(t,i,a,s,n,k){this.formBuilder=t,this.categoryService=i,this.messageService=a,this.router=s,this.ref=n,this.categoryDTO=k,this.destroy$=new x.x,this.isLoading=!1,this.categoriesDatas=[],this.addCategorieForm=this.formBuilder.group({name:["",c.kI.required]}),this.editCategorieForm=this.formBuilder.group({name:["",c.kI.required]}),this.addCategorieAction=g.ADD_CATEGORY_EVNT,this.editCategorieAction=g.EDIT_CATEGORY_EVENT}ngOnInit(){this.categorytAction=this.ref?.data,console.log(this.categorytAction),console.log(this.categorytAction.categoriesDatas),this.categorytAction.event.action===this.editCategorieAction&&this.categorytAction.categoriesDatas&&(console.log("entrou aqui"),this.getCategorieSelectedDatas(this.categorytAction?.event?.id)),this.getAllCategories()}getAllCategories(){this.isLoading=!0,this.categoryService.getAllCategories().pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.categoriesDatas=t,this.isLoading=!1)},error:t=>{console.log(t),this.messageService.add({severity:"error",summary:"Erro.",detail:"Erro ao buscar categorias",life:2500}),this.isLoading=!1}})}handleSubmitAddCategory(){this.isLoading=!0,this.addCategorieForm.valid?this.categoryService.createCategorie(this.addCategorieForm.value).pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t&&(this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Categoria Criada com sucesso",life:2500}),this.isLoading=!1)},error:t=>{console.log(t),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao criar categoria",life:2500}),this.isLoading=!1}}):(this.messageService.add({severity:"error",summary:"Erro",detail:"Por favor, preencha todos os campos corretamente",life:2500}),this.isLoading=!1),this.addCategorieForm.reset()}handleSubmitEditCategory(){this.isLoading=!0,this.editCategorieForm.value&&this.editCategorieForm.valid&&this.categorytAction?.event?.id&&this.categoryService.updateCategorie({categoryId:this.categorytAction?.event?.id,name:this.editCategorieForm?.value?.name}).pipe((0,l.R)(this.destroy$)).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Sucesso",detail:"Categoria editada  com sucesso",life:2500}),this.editCategorieForm.reset(),this.isLoading=!1},error:i=>{console.log(i),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao editar Categoria",life:2500}),this.editCategorieForm.reset(),this.isLoading=!1}})}getCategorieSelectedDatas(t){const i=this.categorytAction?.categoriesDatas;if(console.log(t),console.log(i),i&&i.length>0){const a=i.find(s=>s.categoryId===t);a&&(this.categoriesSelectedDatas=a,this.editCategorieForm.patchValue({name:this.categoriesSelectedDatas?.name}))}}getCategoriesDatas(){this.categoryService.getAllCategories().pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.categoriesDatas=t,this.categoriesDatas&&this.categoryDTO.setCategoriesDatas(this.categoriesDatas))}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(c.qu),e.Y36(A.H),e.Y36(p.ez),e.Y36(y.F0),e.Y36(h.S),e.Y36(Z))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-category-form"]],decls:2,vars:2,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],[3,"style",4,"ngIf"],[1,"card","flex","flex-column","md:flex-column","gap-3"],["pInputText","","placeholder","Nome","formControlName","name"],[1,"flex","flex-row","justify-content-center","align-content-center","align-items-center","m-1"],["type","submit","label","Concluir",3,"disabled"]],template:function(i,a){1&i&&(e.YNc(0,L,7,3,"div",0),e.YNc(1,_,6,2,"div",0)),2&i&&(e.Q6J("ngIf",(null==a.categorytAction||null==a.categorytAction.event?null:a.categorytAction.event.action)===a.addCategorieAction),e.xp6(1),e.Q6J("ngIf",(null==a.categorytAction.event?null:a.categorytAction.event.action)===a.editCategorieAction))},dependencies:[C.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,u.zx,E.o,f.G]})}return o})();var N=r(52),T=r(2137),b=r(4247),m=r(4684),S=r(3608);function R(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"th",7)(2,"div",8)(3,"div",8),e._uU(4," Nome "),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"p-sortIcon",9)(7,"p-columnFilter",10),e.qZA()()(),e.TgZ(8,"th")(9,"div",11)(10,"p-button",12),e.NdJ("onClick",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.handleCategoryEvent(a.addCategoryEvent))}),e.qZA()()()()}2&o&&(e.xp6(7),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1))}function $(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"div",13)(5,"button",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,n=e.oxw();return e.KtG(n.handleCategoryEvent(n.editCategoryEvent,null==s?null:s.categoryId))}),e.qZA(),e.TgZ(6,"button",15),e.NdJ("click",function(){const s=e.CHM(t).$implicit,n=e.oxw();return e.KtG(n.handleDeleteCategory(null==s?null:s.categoryId,null==s?null:s.name))}),e.qZA()()()()}if(2&o){const t=d.$implicit;e.xp6(2),e.Oqu(null==t?null:t.name)}}const O=function(){return["mane","amount"]},M=function(){return{"min-width":"75rem"}};let w=(()=>{class o{constructor(){this.addCategoryEvent=g.ADD_CATEGORY_EVNT,this.editCategoryEvent=g.EDIT_CATEGORY_EVENT,this.categories=[],this.categoryEvent=new e.vpe,this.deleteCategoryEvent=new e.vpe}handleCategoryEvent(t,i){t&&""!==t&&this.categoryEvent.emit(i&&null!==i?{action:t,id:i}:{action:t})}handleDeleteCategory(t,i){null!==t&&""!==i&&this.deleteCategoryEvent.emit({categorie_id:t,categorie_name:i})}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-category-table"]],inputs:{categories:"categories"},outputs:{categoryEvent:"categoryEvent",deleteCategoryEvent:"deleteCategoryEvent"},decls:7,vars:11,consts:[[1,"grid"],[1,"col-12"],["styleClass","shadow-3 m-5 text-indigo-800","header","Categorias de produtos"],["dataKey","id","currentPageReportTemplate","Mostrando {first} de {last} de {totalRecords} Categorias",3,"value","rows","paginator","responsive","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","selectionChange"],["productsTable",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","name"],[1,"flex","justify-content-between","align-items-center"],["field","name"],["type","text","field","name","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],[1,"flex","justify-content-center"],["styleClass","p-button-info","icon","pi pi-plus","label","Adicionar","pTooltip","Adicionar Categoria","tooltipPosition","top",3,"onClick"],[1,"flex","justify-content-center","gap-3","align-content-center","align-items-center"],["pButton","","pRipple","","icon","pi pi-pencil","pTooltip","Editar Categoria","tooltipPosition","top",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","icon","pi pi-trash","pTooltip","Remover Categoria","tooltipPosition","top",1,"p-button-rounded","p-button-danger",3,"click"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"p-card",2)(3,"p-table",3,4),e.NdJ("selectionChange",function(n){return a.categorieSelected=n}),e.YNc(5,R,11,3,"ng-template",5),e.YNc(6,$,7,1,"ng-template",6),e.qZA()()()()),2&i&&(e.xp6(3),e.Q6J("value",a.categories)("rows",10)("paginator",!0)("responsive",!0)("globalFilterFields",e.DdM(9,O))("tableStyle",e.DdM(10,M))("selection",a.categorieSelected)("rowHover",!0)("showCurrentPageReport",!0))},dependencies:[b.Z,p.jx,u.Hq,u.zx,m.iA,m.lQ,m.fz,m.xl,S.u]})}return o})();const G=function(){return{width:"50px",height:"50px",position:"fixed",top:"50%",left:"50%","margin-top":"-25px","margin-left":"-25px"}};function H(o,d){1&o&&e._UZ(0,"p-progressSpinner"),2&o&&e.Akn(e.DdM(2,G))}const U=function(){return{width:"50vw"}},P=[{path:"",component:(()=>{class o{constructor(t,i,a,s,n){this.categoriesService=t,this.dialogService=i,this.messageService=a,this.confirmationService=s,this.router=n,this.destroy$=new x.x,this.categoriesDatas=[],this.isLoading=!1}ngOnInit(){this.getAllCategories()}getAPICategoriesDatas(){this.isLoading=!0,this.categoriesService.getAllCategories().pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.categoriesDatas=t,this.isLoading=!1)},error:t=>{console.log(t),this.router.navigate(["/dashboard"]),this.messageService.add({severity:"error",summary:"Erro.",detail:"Erro ao buscar categorias.",life:2e3}),this.isLoading=!1}})}getAllCategories(){this.isLoading=!0,this.categoriesService.getAllCategories().pipe((0,l.R)(this.destroy$)).subscribe({next:t=>{t.length>0&&(this.categoriesDatas=t,this.isLoading=!1)},error:t=>{console.log(t),this.messageService.add({severity:"error",summary:"Erro.",detail:"Erro ao buscar categorias",life:2500}),this.router.navigate(["/dashboard"]),this.isLoading=!1}})}handleCategoryAction(t){t&&(console.log(t),this.ref=this.dialogService.open(J,{header:t?.action,width:"70%",contentStyle:{overFlow:"auto"},baseZIndex:1e4,maximizable:!0,data:{event:t,categoriesDatas:this.categoriesDatas}}),this.ref.onClose.pipe((0,l.R)(this.destroy$)).subscribe({next:()=>this.getAPICategoriesDatas()}))}handleDeleteCategorieAction(t){t&&this.confirmationService.confirm({message:`Confirma a exclus\xe3o da categoria ${t?.categorie_name}?`,header:"Confirma\xe7\xe3o de exclus\xe3o",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"N\xe3o",accept:()=>this.deleteCategory(t?.categorie_id)})}deleteCategory(t){this.categoriesService.deleteCategorie(t).pipe((0,l.R)(this.destroy$)).subscribe({next:i=>{this.getAPICategoriesDatas(),this.messageService.add({severity:"success",summary:"Sucesso",detail:"Categoria removida com sucesso",life:2500})},error:i=>{console.log(i),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao deletar a categoria",life:2500})}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(A.H),e.Y36(h.xA),e.Y36(p.ez),e.Y36(p.YP),e.Y36(y.F0))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-category-home"]],decls:4,vars:5,consts:[[3,"style",4,"ngIf"],[3,"categories","categoryEvent","deleteCategoryEvent"]],template:function(i,a){1&i&&(e._UZ(0,"app-toolbar-navigation"),e.YNc(1,H,1,3,"p-progressSpinner",0),e.TgZ(2,"app-category-table",1),e.NdJ("categoryEvent",function(n){return a.handleCategoryAction(n)})("deleteCategoryEvent",function(n){return a.handleDeleteCategorieAction(n)}),e.qZA(),e._UZ(3,"p-confirmDialog")),2&i&&(e.xp6(1),e.Q6J("ngIf",a.isLoading),e.xp6(1),e.Q6J("categories",a.categoriesDatas),e.xp6(1),e.Akn(e.DdM(4,U)))},dependencies:[C.O5,N.p,T.Q,f.G,w]})}return o})()}];var Q=r(4466),z=r(529),j=r(3520),B=r(7913),V=r(3054),K=r(7188),X=r(4028);let W=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({providers:[h.xA,p.YP],imports:[C.ez,c.u5,c.UX,y.Bz.forChild(P),Q.m,z.JF,b.d,u.hJ,m.U$,E.j,j.zz,B.Iu,V.A,K.L$,h.DL,X.kW,T.D,S.z,f.L]})}return o})()}}]);